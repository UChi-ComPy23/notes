Traceback (most recent call last):
  File "/home/goodwill/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/goodwill/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/goodwill/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/goodwill/miniconda3/envs/pycourse_test/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/goodwill/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/home/goodwill/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/goodwill/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
from numba import vectorize

@vectorize(['float32(float32, float32)'], target='cuda')
def numba_add_cuda(a, b):
    return a + b
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mOSError[0m                                   Traceback (most recent call last)
File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/cuda/cudadrv/nvvm.py:139[0m, in [0;36mNVVM.__new__[0;34m(cls)[0m
[1;32m    138[0m [38;5;28;01mtry[39;00m:
[0;32m--> 139[0m     inst[38;5;241m.[39mdriver [38;5;241m=[39m open_cudalib([38;5;124m'[39m[38;5;124mnvvm[39m[38;5;124m'[39m)
[1;32m    140[0m [38;5;28;01mexcept[39;00m [38;5;167;01mOSError[39;00m [38;5;28;01mas[39;00m e:

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/cuda/cudadrv/libs.py:64[0m, in [0;36mopen_cudalib[0;34m(lib)[0m
[1;32m     63[0m path [38;5;241m=[39m get_cudalib(lib)
[0;32m---> 64[0m [38;5;28;01mreturn[39;00m ctypes[38;5;241m.[39mCDLL(path)

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/ctypes/__init__.py:376[0m, in [0;36mCDLL.__init__[0;34m(self, name, mode, handle, use_errno, use_last_error, winmode)[0m
[1;32m    375[0m [38;5;28;01mif[39;00m handle [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 376[0m     [38;5;28mself[39m[38;5;241m.[39m_handle [38;5;241m=[39m _dlopen([38;5;28mself[39m[38;5;241m.[39m_name, mode)
[1;32m    377[0m [38;5;28;01melse[39;00m:

[0;31mOSError[0m: libnvvm.so: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

[0;31mNvvmSupportError[0m                          Traceback (most recent call last)
Cell [0;32mIn[20], line 3[0m
[1;32m      1[0m [38;5;28;01mfrom[39;00m [38;5;21;01mnumba[39;00m [38;5;28;01mimport[39;00m vectorize
[0;32m----> 3[0m [38;5;129m@vectorize[39m([[38;5;124m'[39m[38;5;124mfloat32(float32, float32)[39m[38;5;124m'[39m], target[38;5;241m=[39m[38;5;124m'[39m[38;5;124mcuda[39m[38;5;124m'[39m)
[1;32m      4[0m [38;5;28;01mdef[39;00m [38;5;21mnumba_add_cuda[39m(a, b):
[1;32m      5[0m     [38;5;28;01mreturn[39;00m a [38;5;241m+[39m b

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/np/ufunc/decorators.py:131[0m, in [0;36mvectorize.<locals>.wrap[0;34m(func)[0m
[1;32m    129[0m vec [38;5;241m=[39m Vectorize(func, [38;5;241m*[39m[38;5;241m*[39mkws)
[1;32m    130[0m [38;5;28;01mfor[39;00m sig [38;5;129;01min[39;00m ftylist:
[0;32m--> 131[0m     vec[38;5;241m.[39madd(sig)
[1;32m    132[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(ftylist) [38;5;241m>[39m [38;5;241m0[39m:
[1;32m    133[0m     vec[38;5;241m.[39mdisable_compile()

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/np/ufunc/deviceufunc.py:391[0m, in [0;36mDeviceVectorize.add[0;34m(self, sig)[0m
[1;32m    388[0m funcname [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mpyfunc[38;5;241m.[39m[38;5;18m__name__[39m
[1;32m    389[0m kernelsource [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_get_kernel_source([38;5;28mself[39m[38;5;241m.[39m_kernel_template,
[1;32m    390[0m                                        devfnsig, funcname)
[0;32m--> 391[0m corefn, return_type [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_compile_core(devfnsig)
[1;32m    392[0m glbl [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_get_globals(corefn)
[1;32m    393[0m sig [38;5;241m=[39m signature(types[38;5;241m.[39mvoid, [38;5;241m*[39m([a[:] [38;5;28;01mfor[39;00m a [38;5;129;01min[39;00m args] [38;5;241m+[39m [return_type[:]]))

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/cuda/vectorizers.py:202[0m, in [0;36mCUDAVectorize._compile_core[0;34m(self, sig)[0m
[1;32m    201[0m [38;5;28;01mdef[39;00m [38;5;21m_compile_core[39m([38;5;28mself[39m, sig):
[0;32m--> 202[0m     cudevfn [38;5;241m=[39m cuda[38;5;241m.[39mjit(sig, device[38;5;241m=[39m[38;5;28;01mTrue[39;00m, inline[38;5;241m=[39m[38;5;28;01mTrue[39;00m)([38;5;28mself[39m[38;5;241m.[39mpyfunc)
[1;32m    203[0m     [38;5;28;01mreturn[39;00m cudevfn, cudevfn[38;5;241m.[39moverloads[sig[38;5;241m.[39margs][38;5;241m.[39msignature[38;5;241m.[39mreturn_type

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/cuda/decorators.py:131[0m, in [0;36mjit.<locals>._jit[0;34m(func)[0m
[1;32m    129[0m     [38;5;28;01mfrom[39;00m [38;5;21;01mnumba[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcore[39;00m [38;5;28;01mimport[39;00m typeinfer
[1;32m    130[0m     [38;5;28;01mwith[39;00m typeinfer[38;5;241m.[39mregister_dispatcher(disp):
[0;32m--> 131[0m         disp[38;5;241m.[39mcompile_device(argtypes, restype)
[1;32m    132[0m [38;5;28;01melse[39;00m:
[1;32m    133[0m     disp[38;5;241m.[39mcompile(argtypes)

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/cuda/dispatcher.py:877[0m, in [0;36mCUDADispatcher.compile_device[0;34m(self, args, return_type)[0m
[1;32m    871[0m nvvm_options [38;5;241m=[39m {
[1;32m    872[0m     [38;5;124m'[39m[38;5;124mopt[39m[38;5;124m'[39m: [38;5;241m3[39m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mtargetoptions[38;5;241m.[39mget([38;5;124m'[39m[38;5;124mopt[39m[38;5;124m'[39m) [38;5;28;01melse[39;00m [38;5;241m0[39m,
[1;32m    873[0m     [38;5;124m'[39m[38;5;124mfastmath[39m[38;5;124m'[39m: fastmath
[1;32m    874[0m }
[1;32m    876[0m cc [38;5;241m=[39m get_current_device()[38;5;241m.[39mcompute_capability
[0;32m--> 877[0m cres [38;5;241m=[39m compile_cuda([38;5;28mself[39m[38;5;241m.[39mpy_func, return_type, args,
[1;32m    878[0m                     debug[38;5;241m=[39mdebug,
[1;32m    879[0m                     lineinfo[38;5;241m=[39mlineinfo,
[1;32m    880[0m                     inline[38;5;241m=[39minline,
[1;32m    881[0m                     fastmath[38;5;241m=[39mfastmath,
[1;32m    882[0m                     nvvm_options[38;5;241m=[39mnvvm_options,
[1;32m    883[0m                     cc[38;5;241m=[39mcc)
[1;32m    884[0m [38;5;28mself[39m[38;5;241m.[39moverloads[args] [38;5;241m=[39m cres
[1;32m    886[0m cres[38;5;241m.[39mtarget_context[38;5;241m.[39minsert_user_function(cres[38;5;241m.[39mentry_point,
[1;32m    887[0m                                          cres[38;5;241m.[39mfndesc,
[1;32m    888[0m                                          [cres[38;5;241m.[39mlibrary])

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler_lock.py:35[0m, in [0;36m_CompilerLock.__call__.<locals>._acquire_compile_lock[0;34m(*args, **kwargs)[0m
[1;32m     32[0m [38;5;129m@functools[39m[38;5;241m.[39mwraps(func)
[1;32m     33[0m [38;5;28;01mdef[39;00m [38;5;21m_acquire_compile_lock[39m([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m     34[0m     [38;5;28;01mwith[39;00m [38;5;28mself[39m:
[0;32m---> 35[0m         [38;5;28;01mreturn[39;00m func([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/cuda/compiler.py:230[0m, in [0;36mcompile_cuda[0;34m(pyfunc, return_type, args, debug, lineinfo, inline, fastmath, nvvm_options, cc)[0m
[1;32m    228[0m [38;5;28;01mfrom[39;00m [38;5;21;01mnumba[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcore[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtarget_extension[39;00m [38;5;28;01mimport[39;00m target_override
[1;32m    229[0m [38;5;28;01mwith[39;00m target_override([38;5;124m'[39m[38;5;124mcuda[39m[38;5;124m'[39m):
[0;32m--> 230[0m     cres [38;5;241m=[39m compiler[38;5;241m.[39mcompile_extra(typingctx[38;5;241m=[39mtypingctx,
[1;32m    231[0m                                   targetctx[38;5;241m=[39mtargetctx,
[1;32m    232[0m                                   func[38;5;241m=[39mpyfunc,
[1;32m    233[0m                                   args[38;5;241m=[39margs,
[1;32m    234[0m                                   return_type[38;5;241m=[39mreturn_type,
[1;32m    235[0m                                   flags[38;5;241m=[39mflags,
[1;32m    236[0m                                   [38;5;28mlocals[39m[38;5;241m=[39m{},
[1;32m    237[0m                                   pipeline_class[38;5;241m=[39mCUDACompiler)
[1;32m    239[0m library [38;5;241m=[39m cres[38;5;241m.[39mlibrary
[1;32m    240[0m library[38;5;241m.[39mfinalize()

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler.py:762[0m, in [0;36mcompile_extra[0;34m(typingctx, targetctx, func, args, return_type, flags, locals, library, pipeline_class)[0m
[1;32m    738[0m [38;5;250m[39m[38;5;124;03m"""Compiler entry point[39;00m
[1;32m    739[0m 
[1;32m    740[0m [38;5;124;03mParameter[39;00m
[0;32m   (...)[0m
[1;32m    758[0m [38;5;124;03m    compiler pipeline[39;00m
[1;32m    759[0m [38;5;124;03m"""[39;00m
[1;32m    760[0m pipeline [38;5;241m=[39m pipeline_class(typingctx, targetctx, library,
[1;32m    761[0m                           args, return_type, flags, [38;5;28mlocals[39m)
[0;32m--> 762[0m [38;5;28;01mreturn[39;00m pipeline[38;5;241m.[39mcompile_extra(func)

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler.py:460[0m, in [0;36mCompilerBase.compile_extra[0;34m(self, func)[0m
[1;32m    458[0m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mlifted [38;5;241m=[39m ()
[1;32m    459[0m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mlifted_from [38;5;241m=[39m [38;5;28;01mNone[39;00m
[0;32m--> 460[0m [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compile_bytecode()

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler.py:528[0m, in [0;36mCompilerBase._compile_bytecode[0;34m(self)[0m
[1;32m    524[0m [38;5;250m[39m[38;5;124;03m"""[39;00m
[1;32m    525[0m [38;5;124;03mPopulate and run pipeline for bytecode input[39;00m
[1;32m    526[0m [38;5;124;03m"""[39;00m
[1;32m    527[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfunc_ir [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m
[0;32m--> 528[0m [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compile_core()

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler.py:507[0m, in [0;36mCompilerBase._compile_core[0;34m(self)[0m
[1;32m    505[0m         [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstatus[38;5;241m.[39mfail_reason [38;5;241m=[39m e
[1;32m    506[0m         [38;5;28;01mif[39;00m is_final_pipeline:
[0;32m--> 507[0m             [38;5;28;01mraise[39;00m e
[1;32m    508[0m [38;5;28;01melse[39;00m:
[1;32m    509[0m     [38;5;28;01mraise[39;00m CompilerError([38;5;124m"[39m[38;5;124mAll available pipelines exhausted[39m[38;5;124m"[39m)

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler.py:494[0m, in [0;36mCompilerBase._compile_core[0;34m(self)[0m
[1;32m    492[0m res [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    493[0m [38;5;28;01mtry[39;00m:
[0;32m--> 494[0m     pm[38;5;241m.[39mrun([38;5;28mself[39m[38;5;241m.[39mstate)
[1;32m    495[0m     [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mcr [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m    496[0m         [38;5;28;01mbreak[39;00m

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler_machinery.py:368[0m, in [0;36mPassManager.run[0;34m(self, state)[0m
[1;32m    365[0m msg [38;5;241m=[39m [38;5;124m"[39m[38;5;124mFailed in [39m[38;5;132;01m%s[39;00m[38;5;124m mode pipeline (step: [39m[38;5;132;01m%s[39;00m[38;5;124m)[39m[38;5;124m"[39m [38;5;241m%[39m \
[1;32m    366[0m     ([38;5;28mself[39m[38;5;241m.[39mpipeline_name, pass_desc)
[1;32m    367[0m patched_exception [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_patch_error(msg, e)
[0;32m--> 368[0m [38;5;28;01mraise[39;00m patched_exception

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler_machinery.py:356[0m, in [0;36mPassManager.run[0;34m(self, state)[0m
[1;32m    354[0m pass_inst [38;5;241m=[39m _pass_registry[38;5;241m.[39mget(pss)[38;5;241m.[39mpass_inst
[1;32m    355[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(pass_inst, CompilerPass):
[0;32m--> 356[0m     [38;5;28mself[39m[38;5;241m.[39m_runPass(idx, pass_inst, state)
[1;32m    357[0m [38;5;28;01melse[39;00m:
[1;32m    358[0m     [38;5;28;01mraise[39;00m [38;5;167;01mBaseException[39;00m([38;5;124m"[39m[38;5;124mLegacy pass in use[39m[38;5;124m"[39m)

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler_lock.py:35[0m, in [0;36m_CompilerLock.__call__.<locals>._acquire_compile_lock[0;34m(*args, **kwargs)[0m
[1;32m     32[0m [38;5;129m@functools[39m[38;5;241m.[39mwraps(func)
[1;32m     33[0m [38;5;28;01mdef[39;00m [38;5;21m_acquire_compile_lock[39m([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m     34[0m     [38;5;28;01mwith[39;00m [38;5;28mself[39m:
[0;32m---> 35[0m         [38;5;28;01mreturn[39;00m func([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler_machinery.py:311[0m, in [0;36mPassManager._runPass[0;34m(self, index, pss, internal_state)[0m
[1;32m    309[0m     mutated [38;5;241m|[39m[38;5;241m=[39m check(pss[38;5;241m.[39mrun_initialization, internal_state)
[1;32m    310[0m [38;5;28;01mwith[39;00m SimpleTimer() [38;5;28;01mas[39;00m pass_time:
[0;32m--> 311[0m     mutated [38;5;241m|[39m[38;5;241m=[39m check(pss[38;5;241m.[39mrun_pass, internal_state)
[1;32m    312[0m [38;5;28;01mwith[39;00m SimpleTimer() [38;5;28;01mas[39;00m finalize_time:
[1;32m    313[0m     mutated [38;5;241m|[39m[38;5;241m=[39m check(pss[38;5;241m.[39mrun_finalizer, internal_state)

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/core/compiler_machinery.py:273[0m, in [0;36mPassManager._runPass.<locals>.check[0;34m(func, compiler_state)[0m
[1;32m    272[0m [38;5;28;01mdef[39;00m [38;5;21mcheck[39m(func, compiler_state):
[0;32m--> 273[0m     mangled [38;5;241m=[39m func(compiler_state)
[1;32m    274[0m     [38;5;28;01mif[39;00m mangled [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m ([38;5;28;01mTrue[39;00m, [38;5;28;01mFalse[39;00m):
[1;32m    275[0m         msg [38;5;241m=[39m ([38;5;124m"[39m[38;5;124mCompilerPass implementations should return True/False. [39m[38;5;124m"[39m
[1;32m    276[0m                [38;5;124m"[39m[38;5;124mCompilerPass with name [39m[38;5;124m'[39m[38;5;132;01m%s[39;00m[38;5;124m'[39m[38;5;124m did not.[39m[38;5;124m"[39m)

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/cuda/compiler.py:128[0m, in [0;36mCUDALegalization.run_pass[0;34m(self, state)[0m
[1;32m    125[0m [38;5;28;01mdef[39;00m [38;5;21mrun_pass[39m([38;5;28mself[39m, state):
[1;32m    126[0m     [38;5;66;03m# Early return if NVVM 7[39;00m
[1;32m    127[0m     [38;5;28;01mfrom[39;00m [38;5;21;01mnumba[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcuda[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcudadrv[39;00m[38;5;21;01m.[39;00m[38;5;21;01mnvvm[39;00m [38;5;28;01mimport[39;00m NVVM
[0;32m--> 128[0m     [38;5;28;01mif[39;00m NVVM()[38;5;241m.[39mis_nvvm70:
[1;32m    129[0m         [38;5;28;01mreturn[39;00m [38;5;28;01mFalse[39;00m
[1;32m    130[0m     [38;5;66;03m# NVVM < 7, need to check for charseq[39;00m

File [0;32m~/miniconda3/envs/pycourse_test/lib/python3.11/site-packages/numba/cuda/cudadrv/nvvm.py:144[0m, in [0;36mNVVM.__new__[0;34m(cls)[0m
[1;32m    141[0m     [38;5;28mcls[39m[38;5;241m.[39m__INSTANCE [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    142[0m     errmsg [38;5;241m=[39m ([38;5;124m"[39m[38;5;124mlibNVVM cannot be found. Do `conda install [39m[38;5;124m"[39m
[1;32m    143[0m               [38;5;124m"[39m[38;5;124mcudatoolkit`:[39m[38;5;130;01m\n[39;00m[38;5;132;01m%s[39;00m[38;5;124m"[39m)
[0;32m--> 144[0m     [38;5;28;01mraise[39;00m NvvmSupportError(errmsg [38;5;241m%[39m e)
[1;32m    146[0m [38;5;66;03m# Find & populate functions[39;00m
[1;32m    147[0m [38;5;28;01mfor[39;00m name, proto [38;5;129;01min[39;00m inst[38;5;241m.[39m_PROTOTYPES[38;5;241m.[39mitems():

[0;31mNvvmSupportError[0m: libNVVM cannot be found. Do `conda install cudatoolkit`:
libnvvm.so: cannot open shared object file: No such file or directory

